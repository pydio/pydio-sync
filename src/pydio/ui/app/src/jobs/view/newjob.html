<md-dialog aria-label="{{_('New Sync Task')}}">
    <form>
        <md-toolbar>
            <div class="md-toolbar-tools">
                <h2>{{_('Create a new Synchronization')}}</h2>
                <span flex></span>
                <md-button class="md-icon-button" ng-click="cancel()">
                    <md-icon>close</md-icon>
                </md-button>
            </div>
            <md-progress-linear md-mode="indeterminate" ng-show="loading"></md-progress-linear>
        </md-toolbar>
        <md-dialog-content style="max-width:800px;max-height:810px;">
            <md-tabs md-dynamic-height md-border-bottom md-selected="selectedTab">
                <md-tab class="login-icons" label="{{_('1. Configure Connection')}}" name="step1">
                    <md-content class="" style="padding: 16px;">
                        <!--<h1 class="md-display-2">{{_('1. Configure Connection')}}</h1>-->
                        <p>{{_('Connect to the server with the same URL as the one you would use to access through a web browser, e.g. http://mydomain.com/pydio.')}}</p>
                        <md-input-container class="md-icon-float md-block">
                            <!-- Use floating label instead of placeholder -->
                            <!--<label><i class="fa fa-server" aria-hidden="true"></i> Remote Server</label>-->
                            <label>{{_('Remote Server')}}</label>
                            <md-icon class="login-icons" aria-hidden="true">dns</md-icon>
                            <input ng-model="NJC.job.server" type="text" md-autofocus="selectedTab === 0"/>
                            <div class="hint" ng-hide="NJC.job.server.startsWith('https')">
                                <md-icon aria-hidden="true" style="font-size: 20px !important;height: 18px;color: orange">warning</md-icon>
                                {{_('If possible use HTTPS for security.')}}
                            </div>
                        </md-input-container>
                        <md-input-container>
                            <!--<label><i class="fa fa-user" aria-hidden="true"></i> Login</label>-->
                            <label>{{_('Login')}}</label>
                            <md-icon class="login-icons" aria-hidden="true">account_circle</md-icon>
                            <input ng-model="NJC.job.user"/>
                        </md-input-container>
                        <md-input-container>
                            <!--<label><i class="fa fa-lock" aria-hidden="true"></i> Password</label>-->
                            <label>{{_('Password')}}</label>
                            <md-icon class="login-icons" aria-hidden="true">lock</md-icon>
                            <input ng-model="NJC.job.password" ng-keyup="NJC.doneWithEnter($event)" type="password"/>
                        </md-input-container>

                        <p ng-click="showURLTip = !showURLTip">{{_('Tip: how do I find my server URL?')}}</p>
                        <md-card ng-show="showURLTip">
                            <md-card-title>
                                <md-card-title-text>
                                    <span class="md-headline">{{_('How can I find my server URL?')}}</span>
                                    <span class="md-subhead">{{_('The server URL is the adress that you can see in your browser when accessing Pydio via the web. It starts with http or https depending on your server configuration. If you are logged in Pydio and you see the last part of the URL starting with "ws-", remove this part and only keep the beginning (see image below).')}}</span>
                                </md-card-title-text>
                            </md-card-title>
                            <md-card-content flex layout-padding>
                                <img class="img-thumbnail" src="assets/images/ServerURL.png" alt="Server url help" style="max-width: 400px; max-height: 400px;">
                            </md-card-content>
                        </md-card>
                        <md-card style="background-color:red; color: white" ng-show="NJC.error">
                            <md-card-title>
                                <md-card-title-text>
                                    <span class="md-headline">Error</span>
                                    <span class="md-subhead">{{NJC.error}}</span>
                                </md-card-title-text>
                            </md-card-title>
                        </md-card>
                    </md-content>
                    <!--{{showNewTask}} {{NJC}} -->
                    <md-content style="padding-bottom:50px">
                        <md-checkbox style="margin-left:16px" ng-model="NJC.job.trust_ssl" ng-init="NJC.job.trust_ssl = false" ng-show="SSL_failed" aria-label="SSL">
                            {{_('Trust SSL certificate.')}}
                        </md-checkbox>
                        <!--<span flex></span>-->
                        <md-content layout="row" style="float:right; margin-right:16px">
                            <md-button ng-click="cancel()">{{_('CANCEL')}}</md-button>
                            <md-button id="connect_button" class="md-primary" ng-click="NJC.loadWorkspaces(); goto('step2')">{{_('CONNECT')}}</md-button>
                        </md-content>
                    </md-content>
                </md-tab>

                <md-tab label="{{_('2. Select a workspace')}}" name="step2" ng-disabled="selectedTab < 1">
                    <md-content class="md-padding">
                        <p>{{_('Welcome, you are now connected to ')}}<em>{{NJC.job.server}}</em>{{('. Please pick a workspace and optionally a sub-folder that will be synced to your local computer.')}}</p>
                        <!--<md-autocomplete
                                placeholder="{{_('Choose a workspace')}}"
                                md-items="item in NJC.job.repositories"
                                md-item-text="item.label"
                        ></md-autocomplete>-->
                        <md-content layout="column" layout-padding>
                            <md-input-container style="margin-top: 50px">
                                <label>{{_('Choose a workspace')}}</label>
                                <md-content layout="row">
                                    <i class="material-icons login-icons" style="padding-top:27px;" aria-hidden="true">work</i>&nbsp;
                                    <md-select ng-model="NJC.job.workspace" style="min-width:242px" ng-click="NJC.job.workspace = ''">
                                        <md-optgroup label="Workspaces">
                                            <md-option ng-value="item" ng-repeat="item in NJC.job.repositories">{{item.label}}</md-option>
                                        </md-optgroup>
                                    </md-select>
                                </md-content>
                            </md-input-container>
                            <md-content layout-padding>
                                <md-checkbox ng-model="singleFolder" ng-show="NJC.job.workspace != ''" ng-click="NJC.loadFolders()">{{_('Sync only a subfolder')}}</md-checkbox>
                                <div ng-show="singleFolder">
                                    <!--{{ NJC.folders }}
                                    {{NJC.job}}-->
                                    <ng-include
                                            ng-repeat="child in NJC.folders"
                                            src="'./src/jobs/view/tree_node.html'"
                                            onload="data = child;job = job"/>
                                </div>
                            </md-content>
                        </md-content>
                        <md-content layout="row" layout-padding>
                            <span flex></span>
                            <md-button ng-click="selectedTab = selectedTab - 1">&lt; {{_('BACK')}}</md-button>
                            <md-button class="md-primary" ng-click="selectedTab = selectedTab + 1" ng-disabled="NJC.job.workspace == ''">{{_('NEXT')}} &gt;</md-button>
                        </md-content>
                    </md-content>
                </md-tab>

                <md-tab label="{{_('3. Select a local folder')}}" name="step3" ng-disabled="selectedTab < 2">
                    <md-content class="md-padding">
                        <p>{{_('The content of My Files / Subfolder will be synced against the following folder on your computer. It will be created by default, or you can change its location.')}}</p>
                        <md-content style="display:flex;">
                            <md-input-container class="md-icon-float md-block" style="flex:1;">
                                <!--<label><i class="fa fa-folder" aria-hidden="true"></i> Local Folder</label>-->
                                <label>{{_('Local Folder')}}</label>
                                <md-icon class="login-icons" ng-click="NJC.openDirChooser($event)" aria-hidden="true">folder</md-icon>
                                <input ng-model="NJC.job.directory" ng-keyup="NJC.doneWithEnter($event)">
                            </md-input-container>
                            <div>
                                <md-button class="md-raised" style="display:inline-block;" ng-click="NJC.openDirChooser($event)">CHOOSE</md-button>
                            </div>
                        </md-content>
                        <md-content layout="row" layout-padding>
                            <span flex></span>
                            <md-button ng-click="selectedTab = selectedTab - 1">&lt;</md-button>
                            <md-button class="md-primary" ng-click="selectedTab = selectedTab + 1; NJC.checkTask();">{{_('REVIEW PARAMETERS')}}</md-button>
                        </md-content>
                    </md-content>
                </md-tab>

                <md-tab label="{{_('Review Sync Task Parameters')}}" name="step4" ng-disabled="selectedTab < 3 || NJC.job.directory.length < 1">
                    <md-content class="md-padding">
                        <div>
                            <p>{{_('Sync is now ready to launch: please verify the parameters and click on start. You can change these parameters later as well.')}}</p>
                            <md-input-container class="md-block md-icon-float">
                                <label>{{_('Label')}}</label>
                                <md-icon class="login-icons" aria-hidden="true">label</md-icon>
                                <input type="text" ng-model="NJC.job.label" id="newjoblabel">
                            </md-input-container>
                            <md-input-container class="md-block md-icon-float">
                                <label>{{_('Remote Server')}}</label>
                                <md-icon class="login-icons" aria-hidden="true">dns</md-icon>
                                <input ng-model="NJC.job.server" disabled>
                            </md-input-container>
                            <md-input-container class="md-block md-icon-float">
                                <label>{{_('Remote Workspace')}}</label>
                                <md-icon class="login-icons" aria-hidden="true">work</md-icon>
                                <input ng-model="NJC.job.workspace.label" disabled>
                            </md-input-container>
                            <md-input-container class="md-block md-icon-float" ng-show="NJC.job.remote_folder != '/'">
                                <label>{{_('Remote Folder')}}</label>
                                <md-icon class="login-icons" aria-hidden="true">folder_shared</md-icon>
                                <input ng-model="NJC.job.remote_folder" disabled>
                            </md-input-container>
                            <md-input-container class="md-block md-icon-float">
                                <label>{{_('Local Folder')}}</label>
                                <md-icon class="login-icons" aria-hidden="true">folder</md-icon>
                                <input ng-model="NJC.job.directory" disabled>
                            </md-input-container>
                            <div layout-gt-sm="row">
                                <md-input-container class="md-block md-icon-float">
                                    <label>{{_('Data Local')}}</label>
                                    <md-icon class="login-icons" aria-hidden="true">data_usage</md-icon>&nbsp;
                                    <input ng-model="NJC.job.total_size" disabled>
                                </md-input-container>
                                <md-input-container class="md-block md-icon-float">
                                    <label>{{_('Data Remote')}}</label>
                                    <md-icon class="login-icons" aria-hidden="true">storage</md-icon>&nbsp;
                                    <input ng-model="NJC.job.total_size" disabled>
                                </md-input-container>
                                <md-input-container class="md-block md-icon-float">
                                    <label>{{_('Estimated Time')}}</label>
                                    <md-icon class="login-icons" aria-hidden="true">timelapse</md-icon>
                                    <input ng-model="NJC.job.eta" disabled>
                                </md-input-container>
                            </div>
                            <div ng-show="NJC.checkedTaskFailed">
                                <md-card style="background-color:red; color: white">
                                    <md-card-title>
                                        <md-card-title-text>
                                            <span class="md-headline">{{ _('A sync task with similar parameters exists.') }}<br></span>
                                            <span class="md-subhead">{{_('Please')}}&nbsp;<a ng-click="selectedTab=1">{{_('change parameters')}}</a></span>
                                        </md-card-title-text>
                                        <md-card-title-media>
                                            <div class="md-media-sm card-media"></div>
                                        </md-card-title-media>
                                    </md-card-title>
                                    <md-card-actions layout="row" layout-align="end center">
                                        <md-button ng-click="selectedTab = 1">{{_('CHANGE PARAMETERS')}}</md-button>
                                    </md-card-actions>
                                </md-card>
                            </div>
                            <div ng-hide="NJC.checkedTaskFolder || NJC.checkedTaskFailed">
                                <md-card style="background-color: orange">
                                    <md-card-title>
                                        <md-card-title-text>
                                            <span class="md-headline">{{ _('A sync task with similar parameters exists.') }}</span>
                                            <span class="md-subhead">{{_('You may want to')}}&nbsp;<a ng-click="selectedTab=2">{{_('change parameters')}}</a></span>
                                        </md-card-title-text>
                                        <md-card-title-media>
                                            <div class="md-media-sm card-media"></div>
                                        </md-card-title-media>
                                    </md-card-title>
                                    <md-card-actions layout="row" layout-align="end center">
                                        <md-button ng-click="selectedTab = 2">{{_('CHANGE PARAMETERS')}}</md-button>
                                    </md-card-actions>
                                </md-card>
                            </div>
                            <div layout="row"> <!-- Lulz who centers things like that??? -->
                                <span flex></span>
                                <md-button md-no-ink class="md-raised" ng-click="showAdvancedParameters = !showAdvancedParameters">{{_('ADVANCED PARAMETERS')}}</md-button>
                                <span flex></span>
                            </div>
                            <div ng-show="showAdvancedParameters">
                                <!--<md-card-title>
                                    <md-card-title-text>
                                        <span class="md-subhead">{{_('ADVANCED PARAMETERS')}}</span>
                                    </md-card-title-text>
                                </md-card-title>-->
                                <md-card-content>
                                    <ng-include src="'./src/jobs/view/advanced.html'"/>
                                </md-card-content>
                            </div>
                        </div>
                        <md-content layout="row" md-layout="padding">
                            <span flex></span>
                            <md-button ng-click="selectedTab = selectedTab - 1">&lt; {{_('BACK')}}</md-button>
                            <md-button class="md-raised md-primary" ng-click="NJC.addTask()" ng-disabled="NJC.checkedTaskFailed">{{_('SAVE AND LAUNCH')}}</md-button>
                        </md-content>
                    </md-content>
                </md-tab>
            </md-tabs>

        </md-dialog-content>
        <!--
        <md-dialog-actions layout="row">
            <md-button href="http://en.wikipedia.org/wiki/Mango" target="_blank" md-autofocus>
                More on Wikipedia
            </md-button>
            <span flex></span>
            <md-button ng-click="answer('not useful')" >
                Not Useful
            </md-button>
            <md-button ng-click="answer('useful')" style="margin-right:20px;" >
                Useful
            </md-button>
        </md-dialog-actions>-->
    </form>
</md-dialog>

